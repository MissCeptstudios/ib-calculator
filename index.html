<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Banking Calculator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 20px; min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const IBCalculator = () => {
  const [display, setDisplay] = useState('0');
  const [previousValue, setPreviousValue] = useState(null);
  const [operation, setOperation] = useState(null);
  const [waitingForOperand, setWaitingForOperand] = useState(false);
  const [history, setHistory] = useState([]);
  const [mode, setMode] = useState('basic');
  const [expression, setExpression] = useState('');
  const [openParentheses, setOpenParentheses] = useState(0);
  const [isDarkMode, setIsDarkMode] = useState(true);
  const [memory, setMemory] = useState({
    wacc: 8.5,
    terminalGrowth: 2.5,
    discountRate: 10,
    revenue: 0,
    ebitda: 0,
    netIncome: 0,
    shares: 0,
    marketCap: 0,
    enterprise: 0,
    debtEquityRatio: 4.0,
    debtEbitdaMultiple: 6.0
  });

  // Exchange rates state - now fetched from API
  const [exchangeRates, setExchangeRates] = useState({
    USD: 1.0000,
    EUR: 0.9150,
    JPY: 142.30,
    GBP: 0.7820,
    CHF: 0.8850,
    CAD: 1.3720,
    CNY: 7.2800,
    PLN: 4.0500,
    AUD: 1.4950,
    SEK: 10.8500
  });
  const [ratesLastUpdated, setRatesLastUpdated] = useState(null);
  const [isLoadingRates, setIsLoadingRates] = useState(false);

  const [selectedCurrency, setSelectedCurrency] = useState('USD');
  const [selectedToCurrency, setSelectedToCurrency] = useState('EUR');
  const [showTutorial, setShowTutorial] = useState(false);

  // Tutorial content for each mode with step-by-step examples
  const getTutorialContent = () => {
    switch (mode) {
      case 'basic':
        return {
          title: '🧮 Basic Calculator Tutorial',
          content: [
            {
              section: '💡 What it does:',
              text: 'Standard calculator with financial shortcuts for quick calculations.'
            },
            {
              section: '✨ Key Features:',
              text: '• Standard arithmetic operations (+, -, ×, ÷)\n• Parentheses for complex expressions\n• Quick multipliers: ×1K, ×1M, ×1B\n• Percentage calculations'
            },
            {
              section: '📝 Step-by-Step Example: Company Valuation',
              text: 'Calculate a company worth 15 million revenue at 12x multiple:\n\n1️⃣ Enter "15"\n2️⃣ Click "×1M" → Display shows: 15,000,000\n3️⃣ Click "×" (multiply)\n4️⃣ Enter "12" (revenue multiple)\n5️⃣ Click "=" → Result: 180,000,000\n6️⃣ This means 180M valuation!'
            },
            {
              section: '🔢 Try These Examples:',
              text: 'Market Cap Calculation:\n• Enter: 50 → ×1M → × → 25 → = (50M shares × $25 = $1.25B)\n\nPercentage Growth:\n• Enter: 100 → + → 15 → % → = (15% of 100 = 15)\n\nComplex Expression:\n• Enter: ( → 100 → + → 50 → ) → × → 1.2 → = (150 × 1.2 = 180)'
            }
          ]
        };
      
      case 'dcf':
        return {
          title: '📊 DCF (Discounted Cash Flow) Tutorial',
          content: [
            {
              section: '💡 What it does:',
              text: 'Values a company based on projected future cash flows discounted to present value using sophisticated financial modeling.'
            },
            {
              section: '📝 Step-by-Step Example: Value a Tech Company',
              text: 'Let\'s value a SaaS company with $50M free cash flow:\n\n1️⃣ Set WACC (discount rate):\n   • Enter "9.5"\n   • Click "Set WACC" → Memory shows: WACC: 9.5%\n\n2️⃣ Set Terminal Growth:\n   • Enter "2.5"\n   • Click "Set TG" → Memory shows: TG: 2.5%\n\n3️⃣ Calculate DCF:\n   • Enter "50" (current FCF in millions)\n   • Click "×1M" → Display: 50,000,000\n   • Click "DCF Model" → Result: ~$850M enterprise value'
            },
            {
              section: '🎯 Model Assumptions:',
              text: '• 5-year projection period\n• Growth starts at 15%, declines 2% annually\n• Terminal value using perpetuity formula\n• Discount rate = WACC (Weighted Average Cost of Capital)\n• All cash flows discounted to present value'
            },
            {
              section: '🔢 Try Different Scenarios:',
              text: 'Conservative Tech Company:\n• WACC: 10% → Terminal: 2% → FCF: $30M\n\nHigh-Growth Startup:\n• WACC: 12% → Terminal: 3% → FCF: $10M\n\nMature Company:\n• WACC: 7% → Terminal: 2% → FCF: $100M'
            },
            {
              section: '📈 IRR Calculation:',
              text: 'Calculate investment returns:\n1️⃣ After DCF, note enterprise value\n2️⃣ Enter expected exit value (e.g., 1200)\n3️⃣ Click "×1M" then "IRR"\n4️⃣ Result shows annual return percentage'
            }
          ]
        };
      
      case 'comps':
        return {
          title: '📈 Comparable Analysis Tutorial',
          content: [
            {
              section: '💡 What it does:',
              text: 'Values companies using trading multiples from similar public companies in the market.'
            },
            {
              section: '📝 Step-by-Step Example: Analyze a SaaS Company',
              text: 'Let\'s analyze a cloud software company:\n\n1️⃣ Set Enterprise Value:\n   • Enter "1500" (company worth $1.5B)\n   • Click "×1M" → Display: 1,500,000,000\n   • Click "Set EV" → Memory shows: EV: 1.5B\n\n2️⃣ Set Market Cap:\n   • Enter "1200"\n   • Click "×1M" → "Set MCap" → Memory: MCap: 1.2B\n\n3️⃣ Calculate Revenue Multiple:\n   • Enter "300" (annual revenue in millions)\n   • Click "×1M" then "EV/Rev"\n   • Result: 5.0x → This company trades at 5x revenue'
            },
            {
              section: '🎯 Understanding Multiples:',
              text: 'EV/EBITDA: How much you pay per dollar of cash flow\n• Tech: 15-25x | Manufacturing: 8-12x\n\nEV/Revenue: Price per dollar of sales\n• SaaS: 4-8x | Retail: 0.5-2x\n\nP/E Ratio: Price per dollar of earnings\n• Growth: 20-30x | Value: 10-15x'
            },
            {
              section: '🔢 Try These Examples:',
              text: 'Mature Software Company:\n• EV: $2B → Revenue: $500M → EV/Rev = 4.0x\n\nHigh-Growth E-commerce:\n• MCap: $800M → Earnings: $40M → P/E = 20x\n\nManufacturing Business:\n• EV: $600M → EBITDA: $60M → EV/EBITDA = 10x'
            }
          ]
        };
      
      case 'lbo':
        return {
          title: '🏦 LBO (Leveraged Buyout) Tutorial',
          content: [
            {
              section: '💡 What it does:',
              text: 'Models private equity acquisitions using debt financing to amplify returns on equity investments.'
            },
            {
              section: '📝 Step-by-Step Example: $500M LBO Deal',
              text: 'Model a leveraged buyout of a stable business:\n\n1️⃣ Calculate Total Deal Size:\n   • Enter "100" (equity investment in millions)\n   • Click "×1M" → Display: 100,000,000\n   • Click "LBO Size" → Result: 500M total deal\n   • This uses 4:1 debt-to-equity ratio\n\n2️⃣ Check Debt Capacity:\n   • Enter "75" (EBITDA in millions)\n   • Click "×1M" then "Debt Cap"\n   • Result: 450M max debt (6x EBITDA)\n\n3️⃣ Calculate Returns:\n   • Enter "800" (exit value after 5 years)\n   • Click "×1M" then "IRR" → Shows annual return\n   • Click "MOIC" → Shows total return multiple'
            },
            {
              section: '🎯 Key LBO Metrics:',
              text: 'Debt-to-Equity: 4.0x (configurable)\n• $100M equity + $400M debt = $500M deal\n\nDebt-to-EBITDA: 6.0x maximum\n• Limits debt based on cash flow coverage\n\nMOIC (Money-on-Money): Total return\n• 3.0x MOIC = $300 return on $100 investment\n\nIRR (Internal Rate of Return): Annual return\n• 20% IRR = 20% annual compound growth'
            },
            {
              section: '🔢 Try Different Scenarios:',
              text: 'Conservative Deal:\n• Equity: $50M → Debt: $200M → Exit: $400M\n\nAggressive Growth:\n• Equity: $200M → Debt: $800M → Exit: $2B\n\nTurnaround Story:\n• Equity: $75M → Debt: $300M → Exit: $600M'
            }
          ]
        };
      
      case 'forex':
        return {
          title: '💱 Foreign Exchange Tutorial',
          content: [
            {
              section: '💡 What it does:',
              text: 'Converts currencies using live exchange rates from official financial data sources.'
            },
            {
              section: '📝 Step-by-Step Example: Convert $10,000 to Euros',
              text: 'Convert US dollars for a European business trip:\n\n1️⃣ Set Currency Pair:\n   • From: "USD" (already selected)\n   • To: Select "EUR" from dropdown\n\n2️⃣ Enter Amount:\n   • Enter "10000" (ten thousand dollars)\n   • Display shows: 10,000\n\n3️⃣ Convert:\n   • Click "Convert to EUR"\n   • Result: ~9,150 EUR (based on live rate)\n   • History shows: "10000.00 USD = 9150.0000 EUR"'
            },
            {
              section: '🔄 Quick Currency Swaps:',
              text: 'Use the ⇄ button to instantly reverse currencies:\n• Currently: USD → EUR\n• Click ⇄ → Now: EUR → USD\n• Same amount converts back automatically'
            },
            {
              section: '📊 Live Exchange Rates:',
              text: 'Rates update automatically when you enter Forex mode:\n• See current rates for all currencies\n• Timestamp shows data freshness\n• Click 🔄 to manually refresh rates\n• Rates sourced from ExchangeRate-API'
            },
            {
              section: '🔢 Try These Examples:',
              text: 'Business Scenarios:\n• Convert €50,000 to GBP for UK acquisition\n• Calculate ¥1,000,000 in USD for Tokyo office\n• Convert CHF 25,000 to USD for Swiss investment\n\nJust enter amount → select currencies → convert!'
            }
          ]
        };
      
      default:
        return { title: 'Calculator Tutorial', content: [] };
    }
  };

  const fetchExchangeRates = async () => {
    setIsLoadingRates(true);
    try {
      const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
      const data = await response.json();
      
      if (data && data.rates) {
        setExchangeRates({
          USD: 1.0000,
          ...data.rates
        });
        setRatesLastUpdated(new Date());
        setHistory(prev => [`Exchange rates updated: ${new Date().toLocaleTimeString()}`, ...prev.slice(0, 19)]);
      }
    } catch (error) {
      console.error('Failed to fetch exchange rates:', error);
      setHistory(prev => [`Failed to update exchange rates - using cached data`, ...prev.slice(0, 19)]);
    } finally {
      setIsLoadingRates(false);
    }
  };

  useEffect(() => {
    if (mode === 'forex') {
      fetchExchangeRates();
    }
  }, [mode]);

  const inputNumber = (num) => {
    if (waitingForOperand) {
      setDisplay(String(num));
      setWaitingForOperand(false);
    } else {
      setDisplay(display === '0' ? String(num) : display + num);
    }
  };

  const inputDecimal = () => {
    if (waitingForOperand) {
      setDisplay('0.');
      setWaitingForOperand(false);
    } else if (display.indexOf('.') === -1) {
      setDisplay(display + '.');
    }
  };

  const clear = () => {
    setDisplay('0');
    setPreviousValue(null);
    setOperation(null);
    setWaitingForOperand(false);
    setExpression('');
    setOpenParentheses(0);
  };

  const addParenthesis = (type) => {
    if (type === 'open') {
      if (waitingForOperand || display === '0') {
        setExpression(prev => prev + '(');
        setDisplay('(');
        setOpenParentheses(prev => prev + 1);
        setWaitingForOperand(true);
      } else {
        setExpression(prev => prev + display + '*(');
        setDisplay('(');
        setOpenParentheses(prev => prev + 1);
        setWaitingForOperand(true);
      }
    } else if (type === 'close' && openParentheses > 0) {
      setExpression(prev => prev + display + ')');
      setDisplay(')');
      setOpenParentheses(prev => prev - 1);
      setWaitingForOperand(true);
    }
  };

  const evaluateExpression = () => {
    try {
      let expr = expression + display;
      
      for (let i = 0; i < openParentheses; i++) {
        expr += ')';
      }
      
      expr = expr.replace(/×/g, '*').replace(/÷/g, '/');
      
      const result = Function('"use strict"; return (' + expr + ')')();
      
      if (isFinite(result)) {
        setDisplay(String(result));
        setHistory(prev => [`${expr} = ${result}`, ...prev.slice(0, 19)]);
        setExpression('');
        setOpenParentheses(0);
        setWaitingForOperand(true);
      }
    } catch (error) {
      setDisplay('Error');
      setWaitingForOperand(true);
    }
  };

  const calculate = (firstValue, secondValue, operation) => {
    switch (operation) {
      case '+': return firstValue + secondValue;
      case '-': return firstValue - secondValue;
      case '×': return firstValue * secondValue;
      case '÷': return secondValue !== 0 ? firstValue / secondValue : 0;
      case '%': return firstValue % secondValue;
      case '^': return Math.pow(firstValue, secondValue);
      default: return secondValue;
    }
  };

  const performOperation = (nextOperation) => {
    const inputValue = parseFloat(display);
    
    if (expression) {
      setExpression(prev => prev + display + nextOperation);
      setWaitingForOperand(true);
      setOperation(nextOperation);
    } else {
      if (previousValue === null) {
        setPreviousValue(inputValue);
      } else if (operation) {
        const currentValue = previousValue || 0;
        const newValue = calculate(currentValue, inputValue, operation);
        setDisplay(String(newValue));
        setPreviousValue(newValue);
        const calculation = `${formatNumber(currentValue)} ${operation} ${formatNumber(inputValue)} = ${formatNumber(newValue)}`;
        setHistory(prev => [calculation, ...prev.slice(0, 19)]);
      }
      setWaitingForOperand(true);
      setOperation(nextOperation);
    }
  };

  const performEquals = () => {
    if (expression || openParentheses > 0) {
      evaluateExpression();
    } else {
      const inputValue = parseFloat(display);
      if (previousValue !== null && operation) {
        const newValue = calculate(previousValue, inputValue, operation);
        const calculation = `${formatNumber(previousValue)} ${operation} ${formatNumber(inputValue)} = ${formatNumber(newValue)}`;
        setHistory(prev => [calculation, ...prev.slice(0, 19)]);
        setDisplay(String(newValue));
        setPreviousValue(null);
        setOperation(null);
        setWaitingForOperand(true);
      }
    }
  };

  const calculateDCF = () => {
    const fcf = parseFloat(display);
    const wacc = memory.wacc / 100;
    const terminalGrowth = memory.terminalGrowth / 100;
    const projectionYears = 5;
    
    let pv = 0;
    const initialGrowth = 0.15;
    const growthDecline = 0.02;
    
    for (let year = 1; year <= projectionYears; year++) {
      const yearGrowth = Math.max(initialGrowth - (growthDecline * (year - 1)), terminalGrowth);
      const fcfYear = fcf * Math.pow(1 + yearGrowth, year);
      pv += fcfYear / Math.pow(1 + wacc, year);
    }
    
    const finalYearGrowth = Math.max(initialGrowth - (growthDecline * projectionYears), terminalGrowth);
    const terminalFCF = fcf * Math.pow(1 + finalYearGrowth, projectionYears) * (1 + terminalGrowth);
    const terminalValue = terminalFCF / (wacc - terminalGrowth);
    const terminalPV = terminalValue / Math.pow(1 + wacc, projectionYears);
    
    const enterpriseValue = pv + terminalPV;
    const result = Math.round(enterpriseValue);
    
    setDisplay(String(result));
    setHistory(prev => [`DCF: FCF=${formatNumber(fcf)}, WACC=${memory.wacc}%, TG=${memory.terminalGrowth}% = ${formatNumber(result)}`, ...prev.slice(0, 19)]);
    setWaitingForOperand(true);
  };

  const calculateMultiple = (metric) => {
    const value = parseFloat(display);
    let result;
    let calculation;
    
    switch (metric) {
      case 'ev_ebitda':
        result = memory.enterprise / value;
        calculation = `EV/EBITDA: ${formatNumber(memory.enterprise)} / ${formatNumber(value)} = ${result.toFixed(1)}x`;
        break;
      case 'pe':
        result = memory.marketCap / value;
        calculation = `P/E: ${formatNumber(memory.marketCap)} / ${formatNumber(value)} = ${result.toFixed(1)}x`;
        break;
      case 'ev_revenue':
        result = memory.enterprise / value;
        calculation = `EV/Revenue: ${formatNumber(memory.enterprise)} / ${formatNumber(value)} = ${result.toFixed(1)}x`;
        break;
      case 'price_book':
        result = memory.marketCap / value;
        calculation = `P/B: ${formatNumber(memory.marketCap)} / ${formatNumber(value)} = ${result.toFixed(1)}x`;
        break;
      case 'ev_sales':
        result = memory.enterprise / value;
        calculation = `EV/Sales: ${formatNumber(memory.enterprise)} / ${formatNumber(value)} = ${result.toFixed(1)}x`;
        break;
      default:
        return;
    }
    
    setDisplay(String(result.toFixed(2)));
    setHistory(prev => [calculation, ...prev.slice(0, 19)]);
    setWaitingForOperand(true);
  };

  const calculateIRR = () => {
    const initialInvestment = memory.enterprise || parseFloat(display);
    const finalValue = parseFloat(display);
    const years = 5;
    
    if (initialInvestment <= 0 || finalValue <= 0) {
      setDisplay('Error');
      return;
    }
    
    const irr = Math.pow(finalValue / initialInvestment, 1/years) - 1;
    const result = irr * 100;
    
    setDisplay(String(result.toFixed(1)));
    setHistory(prev => [`IRR: ${formatNumber(initialInvestment)} → ${formatNumber(finalValue)} (${years}y) = ${result.toFixed(1)}%`, ...prev.slice(0, 19)]);
    setWaitingForOperand(true);
  };

  const storeMemory = (key) => {
    const value = parseFloat(display);
    setMemory(prev => ({ ...prev, [key]: value }));
    setHistory(prev => [`Stored ${key.toUpperCase()}: ${formatNumber(value)}`, ...prev.slice(0, 19)]);
  };

  const recallMemory = (key) => {
    setDisplay(String(memory[key]));
    setWaitingForOperand(true);
  };

  const convertCurrency = (fromCurrency, toCurrency, amount) => {
    const usdAmount = amount / exchangeRates[fromCurrency];
    return usdAmount * exchangeRates[toCurrency];
  };

  const performForexConversion = (toCurrency) => {
    const amount = parseFloat(display);
    if (isNaN(amount) || amount === 0) return;
    
    const convertedAmount = convertCurrency(selectedCurrency, toCurrency, amount);
    const formattedResult = convertedAmount < 0.01 ? convertedAmount.toFixed(6) : convertedAmount.toFixed(4);
    setDisplay(String(formattedResult));
    setHistory(prev => [`${amount.toFixed(2)} ${selectedCurrency} = ${formattedResult} ${toCurrency}`, ...prev.slice(0, 19)]);
    setWaitingForOperand(true);
  };

  const getExchangeRate = (fromCurrency, toCurrency) => {
    return convertCurrency(fromCurrency, toCurrency, 1);
  };

  const getCurrencyName = (code) => {
    const names = {
      USD: 'US Dollar',
      EUR: 'Euro',
      JPY: 'Japanese Yen',
      GBP: 'British Pound',
      CHF: 'Swiss Franc',
      CAD: 'Canadian Dollar',
      CNY: 'Chinese Yuan',
      PLN: 'Polish Zloty',
      AUD: 'Australian Dollar',
      SEK: 'Swedish Krona'
    };
    return names[code] || code;
  };

  const swapCurrencies = () => {
    const temp = selectedCurrency;
    setSelectedCurrency(selectedToCurrency);
    setSelectedToCurrency(temp);
  };

  const formatNumber = (num) => {
    if (Math.abs(num) >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
    if (Math.abs(num) >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (Math.abs(num) >= 1000) return (num / 1000).toFixed(1) + 'K';
    return num.toString();
  };

  const Button = ({ onClick, className = '', children, variant = 'default', size = 'normal' }) => {
    const baseClasses = 'font-semibold rounded-lg transition-all duration-200 active:scale-95 shadow-sm border';
    const sizes = {
      normal: 'h-12 text-sm px-3',
      small: 'h-10 text-xs px-2',
      large: 'h-14 text-base px-4'
    };
    
    const variants = isDarkMode ? {
      default: 'bg-gray-700 hover:bg-gray-600 text-gray-100 border-gray-600 hover:border-gray-500',
      operator: 'bg-gray-800 hover:bg-gray-700 text-yellow-400 border-gray-600 hover:border-yellow-400',
      equals: 'bg-yellow-500 hover:bg-yellow-400 text-black font-bold border-yellow-400',
      function: 'bg-gray-800 hover:bg-gray-700 text-blue-400 border-gray-600',
      clear: 'bg-red-600 hover:bg-red-500 text-white border-red-500',
      ib: 'bg-yellow-600 hover:bg-yellow-500 text-black font-semibold border-yellow-500',
      memory: 'bg-purple-600 hover:bg-purple-500 text-white border-purple-500',
      swap: 'bg-green-600 hover:bg-green-500 text-white font-semibold border-green-500',
      theme: 'bg-gray-600 hover:bg-gray-500 text-yellow-400 border-gray-500 hover:border-yellow-400',
      help: 'bg-blue-600 hover:bg-blue-500 text-white border-blue-500 hover:border-blue-400'
    } : {
      default: 'bg-gray-100 hover:bg-gray-200 text-gray-800 border-gray-300 hover:border-gray-400',
      operator: 'bg-white hover:bg-yellow-50 text-yellow-600 border-yellow-300 hover:border-yellow-400',
      equals: 'bg-yellow-500 hover:bg-yellow-600 text-white font-bold border-yellow-500',
      function: 'bg-white hover:bg-blue-50 text-blue-600 border-blue-300',
      clear: 'bg-red-500 hover:bg-red-600 text-white border-red-500',
      ib: 'bg-yellow-400 hover:bg-yellow-500 text-black font-semibold border-yellow-400',
      memory: 'bg-purple-500 hover:bg-purple-600 text-white border-purple-500',
      swap: 'bg-green-500 hover:bg-green-600 text-white font-semibold border-green-500',
      theme: 'bg-yellow-100 hover:bg-yellow-200 text-gray-800 border-yellow-300 hover:border-yellow-400',
      help: 'bg-blue-500 hover:bg-blue-600 text-white border-blue-500'
    };
    
    return (
      <button
        className={`${baseClasses} ${sizes[size]} ${variants[variant]} ${className}`}
        onClick={onClick}
      >
        {children}
      </button>
    );
  };

  return (
    <div className={`max-w-3xl mx-auto rounded-2xl shadow-2xl p-6 mt-8 border transition-all duration-300 ${
      isDarkMode 
        ? 'bg-gray-900 border-gray-700' 
        : 'bg-white border-gray-200'
    }`}>
      {/* Header */}
      <div className="text-center mb-6">
        <div className="flex items-center justify-between mb-4">
          <Button
            variant="help"
            size="normal"
            onClick={() => setShowTutorial(true)}
            className="w-24 h-12 flex items-center justify-center gap-2 font-bold"
            title={`Learn how to use ${mode.toUpperCase()} mode with examples`}
          >
            <span className="text-lg">❓</span>
            HELP
          </Button>
          <h1 className={`text-2xl font-bold mb-2 ${isDarkMode ? 'text-white' : 'text-gray-800'}`}>
            Investment Banking Calculator
          </h1>
          <Button
            variant="theme"
            size="small"
            onClick={() => setIsDarkMode(!isDarkMode)}
            className="w-12 h-8 flex items-center justify-center"
            title={`Switch to ${isDarkMode ? 'light' : 'dark'} mode`}
          >
            {isDarkMode ? '☀️' : '🌙'}
          </Button>
        </div>
        <p className={`text-sm ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>
          Professional financial modeling and analysis tool
        </p>
      </div>

      {/* Compact Help Cloud - positioned between header and display */}
      {showTutorial && (
        <div className="mb-4">
          <div className={`relative w-full rounded-lg border shadow-lg ${
            isDarkMode 
              ? 'bg-gray-800 border-gray-600' 
              : 'bg-white border-gray-300'
          }`}>
            {/* Cloud pointer pointing up to help button */}
            <div className={`absolute -top-2 left-8 w-4 h-4 transform rotate-45 ${
              isDarkMode ? 'bg-gray-800 border-l border-t border-gray-600' : 'bg-white border-l border-t border-gray-300'
            }`}></div>
            
            <div className="p-4">
              <div className="flex justify-between items-center mb-3">
                <h3 className={`text-sm font-bold ${isDarkMode ? 'text-yellow-400' : 'text-yellow-600'}`}>
                  {mode.toUpperCase()} Quick Guide
                </h3>
                <button
                  onClick={() => setShowTutorial(false)}
                  className={`text-xs w-5 h-5 rounded-full flex items-center justify-center transition-colors ${
                    isDarkMode ? 'text-gray-400 hover:bg-gray-700 hover:text-white' : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  ✕
                </button>
              </div>
              
              <div className="grid grid-cols-3 gap-4">
                {/* Left side - Basic info */}
                <div className="col-span-1">
                  <div className={`p-3 rounded border h-full ${
                    isDarkMode 
                      ? 'bg-gray-700 border-gray-600' 
                      : 'bg-gray-50 border-gray-200'
                  }`}>
                    <h4 className={`font-semibold mb-2 text-xs ${
                      isDarkMode ? 'text-blue-400' : 'text-blue-600'
                    }`}>
                      {getTutorialContent().content[0]?.section}
                    </h4>
                    <p className={`text-xs leading-relaxed ${
                      isDarkMode ? 'text-gray-300' : 'text-gray-700'
                    }`}>
                      {getTutorialContent().content[0]?.text}
                    </p>
                    
                    {getTutorialContent().content[1] && (
                      <div className="mt-3">
                        <h4 className={`font-semibold mb-2 text-xs ${
                          isDarkMode ? 'text-green-400' : 'text-green-600'
                        }`}>
                          {getTutorialContent().content[1]?.section}
                        </h4>
                        <p className={`text-xs leading-relaxed ${
                          isDarkMode ? 'text-gray-300' : 'text-gray-700'
                        }`}>
                          {getTutorialContent().content[1]?.text}
                        </p>
                      </div>
                    )}
                  </div>
                </div>

                {/* Right side - Detailed step-by-step */}
                <div className="col-span-2">
                  <div className={`p-4 rounded border h-full ${
                    isDarkMode 
                      ? 'bg-gray-700 border-gray-600' 
                      : 'bg-blue-50 border-blue-200'
                  }`}>
                    <h4 className={`font-semibold mb-3 text-sm ${
                      isDarkMode ? 'text-yellow-400' : 'text-blue-700'
                    }`}>
                      📋 Step-by-Step Instructions
                    </h4>
                    
                    <div className="space-y-3 max-h-80 overflow-y-auto">
                      {/* Show ALL tutorial content - not just slice(2) */}
                      {getTutorialContent().content.map((item, index) => (
                        <div key={index} className={`p-3 rounded ${
                          isDarkMode 
                            ? 'bg-gray-800' 
                            : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-sm ${
                            isDarkMode ? 'text-orange-400' : 'text-orange-600'
                          }`}>
                            {item.section}
                          </h5>
                          <p className={`text-sm whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            {item.text}
                          </p>
                        </div>
                      ))}
                      
                      {/* Additional practical examples for current mode */}
                      {mode === 'dcf' && (
                        <div className={`p-3 rounded ${
                          isDarkMode ? 'bg-gray-800' : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-xs ${
                            isDarkMode ? 'text-purple-400' : 'text-purple-600'
                          }`}>
                            🎯 Quick DCF Example
                          </h5>
                          <p className={`text-xs whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            1. Enter "50" → Click "×1M" 
                            2. Enter "8.5" → Click "Set WACC"
                            3. Enter "2.5" → Click "Set TG"
                            4. Go back to display showing 50,000,000
                            5. Click "DCF Model" → See enterprise value!
                          </p>
                        </div>
                      )}
                      
                      {mode === 'comps' && (
                        <div className={`p-3 rounded ${
                          isDarkMode ? 'bg-gray-800' : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-xs ${
                            isDarkMode ? 'text-purple-400' : 'text-purple-600'
                          }`}>
                            🎯 Quick Comps Example
                          </h5>
                          <p className={`text-xs whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            1. Enter "1500" → Click "×1M" → Click "Set EV"
                            2. Enter "300" → Click "×1M" 
                            3. Click "EV/Rev" → See 5.0x multiple!
                            4. Try with EBITDA: Enter "150" → "×1M" → "EV/EBITDA"
                          </p>
                        </div>
                      )}
                      
                      {mode === 'lbo' && (
                        <div className={`p-3 rounded ${
                          isDarkMode ? 'bg-gray-800' : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-xs ${
                            isDarkMode ? 'text-purple-400' : 'text-purple-600'
                          }`}>
                            🎯 Quick LBO Example
                          </h5>
                          <p className={`text-xs whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            1. Enter "100" → Click "×1M" → Click "LBO Size"
                            2. Result shows 500M total deal (4:1 leverage)
                            3. Enter "800" → Click "×1M" → Click "IRR"
                            4. See your annual return percentage!
                          </p>
                        </div>
                      )}
                      
                      {mode === 'forex' && (
                        <div className={`p-3 rounded ${
                          isDarkMode ? 'bg-gray-800' : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-xs ${
                            isDarkMode ? 'text-purple-400' : 'text-purple-600'
                          }`}>
                            🎯 Quick Forex Example
                          </h5>
                          <p className={`text-xs whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            1. Set From: USD, To: EUR
                            2. Enter "10000"
                            3. Click "Convert to EUR" 
                            4. See live conversion result!
                            5. Use ⇄ to swap currencies instantly
                          </p>
                        </div>
                      )}
                      
                      {mode === 'basic' && (
                        <div className={`p-3 rounded ${
                          isDarkMode ? 'bg-gray-800' : 'bg-white border border-blue-100'
                        }`}>
                          <h5 className={`font-semibold mb-2 text-xs ${
                            isDarkMode ? 'text-purple-400' : 'text-purple-600'
                          }`}>
                            🎯 Quick Basic Examples
                          </h5>
                          <p className={`text-xs whitespace-pre-line leading-relaxed ${
                            isDarkMode ? 'text-gray-200' : 'text-gray-700'
                          }`}>
                            Valuation: 15 → ×1M → × → 12 → = (180M)
                            Market Cap: 50 → ×1M → × → 25 → = (1.25B)
                            Percentage: 100 → + → 15 → % → = (15% of 100)
                          </p>
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Display */}
      <div className="mb-6">
        <div className={`p-6 rounded-xl mb-4 border transition-all duration-300 ${
          isDarkMode 
            ? 'bg-black text-white border-gray-600' 
            : 'bg-gray-50 text-gray-800 border-gray-200'
        }`}>
          <div className="text-right text-3xl font-mono overflow-hidden mb-2">
            {formatNumber(parseFloat(display) || 0)}
          </div>
          <div className={`text-right text-lg mb-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-600'}`}>
            {parseFloat(display) >= 1000000 ? `${parseFloat(display).toLocaleString()}` : display}
          </div>
          {operation && previousValue !== null && (
            <div className={`text-right text-sm ${isDarkMode ? 'text-gray-400' : 'text-gray-500'}`}>
              {formatNumber(previousValue)} {operation}
            </div>
          )}
          {expression && (
            <div className={`text-right text-sm ${isDarkMode ? 'text-orange-400' : 'text-yellow-600'}`}>
              {expression}{display} {openParentheses > 0 && `(${openParentheses} open)`}
            </div>
          )}
        </div>

        {/* Mode Selector */}
        <div className="flex gap-2 mb-4">
          {[
            { key: 'basic', label: 'BASIC' },
            { key: 'dcf', label: 'DCF' },
            { key: 'comps', label: 'COMPS' },
            { key: 'lbo', label: 'LBO' },
            { key: 'forex', label: 'FOREX' }
          ].map((m) => (
            <Button
              key={m.key}
              variant={mode === m.key ? 'ib' : 'default'}
              size="small"
              onClick={() => {
                setMode(m.key);
                if (m.key === 'forex') {
                  setHistory([]);
                }
              }}
              className="flex-1"
            >
              {m.label}
            </Button>
          ))}
        </div>

        {/* Memory/Status Display */}
        {(mode === 'forex' || (mode !== 'basic' && mode !== 'forex')) && (
          <div className={`p-3 rounded-lg mb-4 border transition-all duration-300 ${
            isDarkMode 
              ? 'bg-gray-800 border-gray-600' 
              : 'bg-gray-100 border-gray-200'
          }`}>
            {mode === 'forex' ? (
              <div>
                <div className="flex justify-between items-center mb-2">
                  <div className={`text-xs ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                    Exchange Rates (Base: {selectedCurrency})
                  </div>
                  <div className="flex items-center gap-2">
                    {ratesLastUpdated && (
                      <div className={`text-xs ${isDarkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                        Updated: {ratesLastUpdated.toLocaleTimeString()}
                      </div>
                    )}
                    <Button
                      variant="function"
                      size="small"
                      onClick={fetchExchangeRates}
                      disabled={isLoadingRates}
                      className="h-6 px-2 text-xs"
                    >
                      {isLoadingRates ? '⟳' : '🔄'}
                    </Button>
                  </div>
                </div>
                <div className="grid grid-cols-5 gap-2 text-xs">
                  {Object.keys(exchangeRates).filter(c => c !== selectedCurrency).slice(0, 8).map(currency => (
                    <div key={currency} className={`px-2 py-1 rounded transition-all duration-300 ${
                      isDarkMode 
                        ? 'bg-gray-700 text-gray-300' 
                        : 'bg-white text-gray-700 border border-gray-200'
                    }`}>
                      {currency}: {getExchangeRate(selectedCurrency, currency).toFixed(currency === 'JPY' ? 2 : 4)}
                    </div>
                  ))}
                </div>
              </div>
            ) : (
              <div>
                <div className={`text-xs mb-2 ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                  Memory Values
                </div>
                <div className="grid grid-cols-4 gap-2 text-xs">
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>WACC: {memory.wacc}%</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>TG: {memory.terminalGrowth}%</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>EV: {formatNumber(memory.enterprise)}</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>MCap: {formatNumber(memory.marketCap)}</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>Rev: {formatNumber(memory.revenue)}</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>EBITDA: {formatNumber(memory.ebitda)}</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>D/E: {memory.debtEquityRatio}x</div>
                  <div className={`px-2 py-1 rounded transition-all duration-300 ${
                    isDarkMode 
                      ? 'bg-gray-700 text-gray-300' 
                      : 'bg-white text-gray-700 border border-gray-200'
                  }`}>D/EBITDA: {memory.debtEbitdaMultiple}x</div>
                </div>
              </div>
            )}
          </div>
        )}

        {/* History */}
        {history.length > 0 && (
          <div className={`p-3 rounded-lg max-h-32 overflow-y-auto border transition-all duration-300 ${
            isDarkMode 
              ? 'bg-gray-800 border-gray-600' 
              : 'bg-gray-100 border-gray-200'
          }`}>
            <div className="flex justify-between items-center mb-2">
              <div className={`text-xs ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>History</div>
              <Button
                variant="clear"
                size="small"
                onClick={() => setHistory([])}
                className="h-5 px-2 text-xs"
              >
                Clear
              </Button>
            </div>
            {history.slice(0, 5).map((calc, index) => (
              <div key={index} className={`text-xs font-mono mb-1 p-1 rounded transition-all duration-300 ${
                isDarkMode 
                  ? 'text-gray-300 bg-gray-700' 
                  : 'text-gray-700 bg-white border border-gray-200'
              }`}>
                {calc}
              </div>
            ))}
          </div>
        )}
      </div>

      {/* Mode-specific functions */}
      {mode === 'forex' && (
        <div className="mb-4">
          <div className="grid grid-cols-5 gap-4 mb-4">
            <div className="col-span-2">
              <label className={`block text-xs mb-2 ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                From Currency
              </label>
              <select
                value={selectedCurrency}
                onChange={(e) => setSelectedCurrency(e.target.value)}
                className={`w-full border rounded-lg px-3 py-2 text-sm focus:outline-none transition-all duration-300 ${
                  isDarkMode 
                    ? 'bg-gray-700 text-white border-gray-500 focus:border-yellow-400' 
                    : 'bg-white text-gray-800 border-gray-300 focus:border-yellow-500'
                }`}
              >
                {Object.keys(exchangeRates).map((currency) => (
                  <option key={currency} value={currency}>
                    {currency} - {getCurrencyName(currency)}
                  </option>
                ))}
              </select>
            </div>
            <div className="flex items-end justify-center">
              <Button 
                variant="swap" 
                size="small"
                onClick={swapCurrencies}
                className="h-10 w-10 flex items-center justify-center p-0"
                title="Swap currencies"
              >
                ⇄
              </Button>
            </div>
            <div className="col-span-2">
              <label className={`block text-xs mb-2 ${isDarkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                To Currency
              </label>
              <select
                value={selectedToCurrency}
                onChange={(e) => setSelectedToCurrency(e.target.value)}
                className={`w-full border rounded-lg px-3 py-2 text-sm focus:outline-none transition-all duration-300 ${
                  isDarkMode 
                    ? 'bg-gray-700 text-white border-gray-500 focus:border-yellow-400' 
                    : 'bg-white text-gray-800 border-gray-300 focus:border-yellow-500'
                }`}
              >
                {Object.keys(exchangeRates).filter(c => c !== selectedCurrency).map((currency) => (
                  <option key={currency} value={currency}>
                    {currency} - {getCurrencyName(currency)}
                  </option>
                ))}
              </select>
            </div>
          </div>
          <div className="grid grid-cols-3 gap-2">
            <Button variant="ib" onClick={() => performForexConversion(selectedToCurrency)}>
              Convert to {selectedToCurrency}
            </Button>
            <Button variant="function" onClick={() => {
              const rate = getExchangeRate(selectedCurrency, selectedToCurrency);
              setDisplay(String(rate.toFixed(6)));
              setWaitingForOperand(true);
            }}>
              Get Rate
            </Button>
            <Button 
              variant="function" 
              onClick={fetchExchangeRates}
              disabled={isLoadingRates}
            >
              {isLoadingRates ? 'Updating...' : 'Update Rates'}
            </Button>
          </div>
        </div>
      )}

      {mode === 'dcf' && (
        <div className="grid grid-cols-4 gap-2 mb-4">
          <Button variant="ib" onClick={calculateDCF}>DCF Model</Button>
          <Button variant="memory" onClick={() => storeMemory('wacc')}>Set WACC</Button>
          <Button variant="memory" onClick={() => storeMemory('terminalGrowth')}>Set TG</Button>
          <Button variant="ib" onClick={calculateIRR}>IRR</Button>
        </div>
      )}

      {mode === 'comps' && (
        <div className="mb-4">
          <div className="grid grid-cols-5 gap-2 mb-2">
            <Button variant="ib" size="small" onClick={() => calculateMultiple('ev_ebitda')}>EV/EBITDA</Button>
            <Button variant="ib" size="small" onClick={() => calculateMultiple('pe')}>P/E</Button>
            <Button variant="ib" size="small" onClick={() => calculateMultiple('ev_revenue')}>EV/Rev</Button>
            <Button variant="ib" size="small" onClick={() => calculateMultiple('price_book')}>P/B</Button>
            <Button variant="ib" size="small" onClick={() => calculateMultiple('ev_sales')}>EV/Sales</Button>
          </div>
        </div>
      )}

      {mode === 'lbo' && (
        <div className="grid grid-cols-4 gap-2 mb-4">
          <Button variant="ib" size="small" onClick={() => {
            const equity = parseFloat(display);
            const debt = equity * memory.debtEquityRatio;
            const totalCost = equity + debt;
            setDisplay(String(totalCost));
            setHistory(prev => [`LBO: Equity=${formatNumber(equity)}, Debt=${formatNumber(debt)}, Total=${formatNumber(totalCost)}`, ...prev.slice(0, 19)]);
            setWaitingForOperand(true);
          }}>LBO Size</Button>
          <Button variant="ib" size="small" onClick={() => {
            const ebitda = parseFloat(display);
            const debtCapacity = ebitda * memory.debtEbitdaMultiple;
            setDisplay(String(debtCapacity));
            setHistory(prev => [`Debt: ${formatNumber(ebitda)} × ${memory.debtEbitdaMultiple}x = ${formatNumber(debtCapacity)}`, ...prev.slice(0, 19)]);
            setWaitingForOperand(true);
          }}>Debt Cap</Button>
          <Button variant="ib" size="small" onClick={calculateIRR}>IRR</Button>
          <Button variant="ib" size="small" onClick={() => {
            const currentVal = parseFloat(display);
            const moic = currentVal / (memory.enterprise || 1);
            setDisplay(String(moic.toFixed(1)));
            setHistory(prev => [`MOIC: ${formatNumber(currentVal)} / ${formatNumber(memory.enterprise)} = ${moic.toFixed(1)}x`, ...prev.slice(0, 19)]);
            setWaitingForOperand(true);
          }}>MOIC</Button>
        </div>
      )}

      {/* Memory Functions */}
      {(mode === 'dcf' || mode === 'comps' || mode === 'lbo') && (
        <div className="grid grid-cols-6 gap-2 mb-4">
          <Button variant="memory" size="small" onClick={() => storeMemory('enterprise')}>Set EV</Button>
          <Button variant="memory" size="small" onClick={() => storeMemory('marketCap')}>Set MCap</Button>
          <Button variant="memory" size="small" onClick={() => storeMemory('revenue')}>Set Rev</Button>
          <Button variant="memory" size="small" onClick={() => storeMemory('ebitda')}>Set EBITDA</Button>
          <Button variant="memory" size="small" onClick={() => recallMemory('enterprise')}>Rcl EV</Button>
          <Button variant="memory" size="small" onClick={() => recallMemory('marketCap')}>Rcl MCap</Button>
        </div>
      )}

      {/* Basic Calculator Layout */}
      <div className="space-y-3">
        <div className="grid grid-cols-4 gap-3">
          <Button variant="clear" onClick={clear}>AC</Button>
          <Button variant="function" onClick={() => setDisplay(display.slice(0, -1) || '0')}>⌫</Button>
          <Button variant="operator" onClick={() => addParenthesis('open')}>(</Button>
          <Button variant="operator" onClick={() => addParenthesis('close')}>)</Button>
        </div>

        <div className="grid grid-cols-4 gap-3">
          <Button onClick={() => inputNumber(7)}>7</Button>
          <Button onClick={() => inputNumber(8)}>8</Button>
          <Button onClick={() => inputNumber(9)}>9</Button>
          <Button variant="operator" onClick={() => performOperation('÷')}>÷</Button>
        </div>

        <div className="grid grid-cols-4 gap-3">
          <Button onClick={() => inputNumber(4)}>4</Button>
          <Button onClick={() => inputNumber(5)}>5</Button>
          <Button onClick={() => inputNumber(6)}>6</Button>
          <Button variant="operator" onClick={() => performOperation('×')}>×</Button>
        </div>

        <div className="grid grid-cols-4 gap-3">
          <Button onClick={() => inputNumber(1)}>1</Button>
          <Button onClick={() => inputNumber(2)}>2</Button>
          <Button onClick={() => inputNumber(3)}>3</Button>
          <Button variant="operator" onClick={() => performOperation('-')}>-</Button>
        </div>

        <div className="grid grid-cols-4 gap-3">
          <Button variant="operator" onClick={() => performOperation('%')}>%</Button>
          <Button onClick={() => inputNumber(0)}>0</Button>
          <Button onClick={inputDecimal}>.</Button>
          <Button variant="operator" onClick={() => performOperation('+')}>+</Button>
        </div>

        <div className="grid grid-cols-4 gap-3">
          <Button variant="function" onClick={() => {
            const val = parseFloat(display);
            setDisplay(String(val * 1000));
            setWaitingForOperand(true);
          }}>×1K</Button>
          <Button variant="function" onClick={() => {
            const val = parseFloat(display);
            setDisplay(String(val * 1000000));
            setWaitingForOperand(true);
          }}>×1M</Button>
          <Button variant="function" onClick={() => {
            const val = parseFloat(display);
            setDisplay(String(val * 1000000000));
            setWaitingForOperand(true);
          }}>×1B</Button>
          <Button variant="equals" onClick={performEquals}>=</Button>
        </div>
      </div>

      {/* Footer */}
      <div className={`text-xs mt-6 text-center transition-all duration-300 ${
        isDarkMode ? 'text-gray-400' : 'text-gray-600'
      }`}>
        <div className="mb-1">IB Calculator v2.1 | Enhanced Financial Modeling Suite</div>
        <div>DCF: Discounted Cash Flow | LBO: Leveraged Buyout | Comps: Comparable Analysis | Forex: Currency Conversion</div>
        {mode === 'forex' && (
          <div className={`mt-1 text-center ${isDarkMode ? 'text-green-400' : 'text-green-600'}`}>
            Live exchange rates from ExchangeRate-API
          </div>
        )}
      </div>
    </div>
  );
};

export default IBCalculator;
        ReactDOM.render(<IBCalculator />, document.getElementById('root'));
    </script>
</body>
</html>
